!function(){var e={847:function(e){self,e.exports=(()=>{"use strict";var e={d:(o,n)=>{for(var t in n)e.o(n,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:n[t]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{downloadVideo:()=>p,logMediaDevices:()=>n,modalContent:()=>i,openVideoPlayback:()=>a,openVideoPreview:()=>r,startRecorder:()=>c,startStream:()=>s,stopRecorder:()=>l,stopStream:()=>d,toggleModal:()=>t,uploadVideo:()=>u});const n=(e=!0,o=!0,n=!1)=>{navigator.mediaDevices.enumerateDevices().then((t=>{t.forEach((t=>{console.log(`${e&&t.kind.toUpperCase()}, ${o&&t.label}, ${n&&t.deviceId}`)}))})).catch((e=>{console.log(e.name,e.message)}))},t=()=>{window.location.href=-1!==window.location.href.indexOf("#greeting-modal")?"#":"#greeting-modal"},i=(e="<h1>Hi</h1>",o="deeppink")=>{const n=document.getElementById("modal-content");document.getElementById("modal").style.backgroundColor=o,"#video-preview"===e?(document.getElementById("video-playback").style.display="none",n.innerHTML="",document.getElementById("video-preview").style.display="block"):"#video-playback"===e?(document.getElementById("video-preview").style.display="none",n.innerHTML="",document.getElementById("video-playback").style.display="block"):(document.getElementById("video-preview").style.display="none",document.getElementById("video-playback").style.display="none",n.innerHTML=e),window.location.href="#greeting-modal"},r=()=>{i("#video-preview","white")},a=()=>{i("#video-playback","white")},s=(e={audio:!0,video:{facingMode:"user",frameRate:15}})=>{navigator.mediaDevices.getUserMedia(e).then((e=>{window.localStream=e;const o=document.querySelector("#video-preview");"srcObject"in o?o.srcObject=e:o.src=window.URL.createObjectURL(e),o.onloadedmetadata=()=>o.play()})).catch((e=>console.log(e.name,e.message)))},d=()=>{"localStream"in window&&window.localStream.getTracks().forEach((e=>e.stop()))},c=(e={audio:!0,video:{facingMode:"user"},frameRate:15})=>{let o={mimeType:"video/webm;codecs=vp9,opus"};MediaRecorder.isTypeSupported(o.mimeType)||(console.error(`${o.mimeType} is not supported, using vp8`),o={mimeType:"video/webm;codecs=vp8,opus"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error(`${o.mimeType} is not supported`),o={mimeType:"video/webm"},MediaRecorder.isTypeSupported(o.mimeType)||(console.error(`${o.mimeType} is not supported`),o={mimeType:""}))),navigator.mediaDevices.getUserMedia(e).then((e=>{window.localStream=e;const n=document.querySelector("#video-preview");"srcObject"in n?n.srcObject=e:n.src=window.URL.createObjectURL(e),n.onloadedmetadata=()=>n.play(),window.MediaRecorder=new MediaRecorder(window.localStream,o),window.dataChunks=[],window.MediaRecorder.start(),console.log(window.MediaRecorder.state),window.MediaRecorder.ondataavailable=e=>window.dataChunks.push(e.data)})).catch((e=>console.log(e.name,e.message)))},l=()=>{"MediaRecorder"in window&&"recording"===window.MediaRecorder.state&&(window.MediaRecorder.stop(),console.log(window.MediaRecorder.state),window.MediaRecorder.onstop=()=>{window.blobvid=new Blob(window.dataChunks,{type:"video/webm"}),window.dataChunks=[],window.videoURL=window.URL.createObjectURL(window.blobvid),document.getElementById("video-playback").src=window.videoURL}),d()},u=(e,o="upload_video.php")=>{if(window.blobvid){const n={fname:(new Date).toISOString().replaceAll(":","-").replace(".","-"),uploadContent:"<h1>Uploading</h1>",uploadColor:"coral",successContent:"<h1>Successful</h1>",successColor:"cyan",...e};i(n.uploadContent,n.uploadColor);const t=o,r=new FormData;r.append("vidfile",window.blobvid,n.fname),fetch(t,{method:"POST",body:r}).then((()=>{i(n.successContent,n.successColor)})).catch(console.error)}else i("<h1>No recording was found ðŸ˜”</h1>","PeachPuff")},p=(e="video.webm")=>{if(window.blobvid){console.log(e);const o=document.createElement("a");o.href=window.videoURL,o.download=e,o.click(),o.remove()}else console.log("No video found in window object")};return(()=>{const e=document.createElement("style");e.innerHTML="\n  /* Greeting Modal Container */\n  #greeting-modal {\n    visibility: hidden;\n    opacity: 0;\n    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);\n  }\n  \n  /* Greeting Modal Container - when open */\n  #greeting-modal:target {\n    visibility: visible;\n    opacity: 1;\n  }\n  \n  /* Greeting Modal */\n  #greeting-modal #modal {\n    opacity: 0;\n    transform: translateY(-1rem);\n    transition: all 0.1s cubic-bezier(0.075, 0.82, 0.165, 1);\n    transition-delay: 0.1s;\n  }\n  \n  /* Greeting Modal - when open */\n  #greeting-modal:target #modal {\n  transform: translateY(0);\n  opacity: 1;\n  }\n  \n  /* Modal Container Styles for flex box */\n  .modal-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    backdrop-filter: blur(5px);\n  }\n  \n  /* Modal Background Styles */\n  .modal-bg {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.3);\n    backdrop-filter: blur(5px);\n  }\n  \n  /* Modal Body Styles */\n  #modal {\n    z-index: 1;\n    background-color: white;\n    width: max-content; /* 500px */\n    padding: 1rem;\n    border-radius: 8px;\n  }\n  \n  #modal .close {\n    position: absolute;\n    right: -16px;\n    top: -16px;\n    width: 32px;\n    height: 32px;\n    opacity: 0.3;\n  }\n  #modal .close:hover {\n    opacity: 1;\n  }\n\n  #modal .close:before, .close:after {\n    position: absolute;\n    left: 16px;\n    content: ' ';\n    height: 34px;\n    width: 3px;\n    background-color: #333;\n  }\n  #modal .close:before {\n    transform: rotate(45deg);\n  }\n  #modal .close:after {\n    transform: rotate(-45deg);\n  }\n  \n  \n",document.head.appendChild(e);const o=document.createRange().createContextualFragment('\n  \x3c!-- Modal container --\x3e\n  <div class="modal-container" id="greeting-modal">\n\n    \x3c!-- Modal  --\x3e\n    <div id="modal">\n      <video id="video-preview" muted style="display: none;"></video>\n      <video id="video-playback" controls style="display: none"></video>\n      <div id="modal-content"></div>\n      <a href="#" class="close">\n    </div>\n\n    \x3c!-- Background, click to close --\x3e\n    <a href="#" class="modal-bg"></a>\n  </div>\n');document.body.appendChild(o)})(),o})()},914:function(e,o,n){"use strict";var t;!function(){var i,r="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if("object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var a=process.versions.node.toString().replace("v","");r="Nodejs/"+a+" (NodeOS) AppleWebKit/"+a+" (KHTML, like Gecko) Nodejs/"+a+" Nodejs/"+a}i=void 0!==n.g?n.g:window,"undefined"==typeof window&&("undefined"==typeof window&&void 0!==n.g&&(n.g.navigator={userAgent:r,getUserMedia:function(){}},i.window=n.g),"undefined"==typeof location&&(i.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(i.screen={width:0,height:0}));var s=window.navigator;void 0!==s?(void 0!==s.webkitGetUserMedia&&(s.getUserMedia=s.webkitGetUserMedia),void 0!==s.mozGetUserMedia&&(s.getUserMedia=s.mozGetUserMedia)):s={getUserMedia:function(){},userAgent:r};var d=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(s.userAgent||""),c=!(-1===s.userAgent.indexOf("Edge")||!s.msSaveOrOpenBlob&&!s.msSaveBlob),l=!!window.opera||s.userAgent.indexOf(" OPR/")>=0,u=s.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(s.userAgent),p=/^((?!chrome|android).)*safari/i.test(s.userAgent),m=!!window.chrome&&!l,w="undefined"!=typeof document&&!!document.documentMode&&!c;function f(e,o){var n=0,t=!1,i=window.setInterval((function(){e()&&(window.clearInterval(i),o(t)),n++>50&&(window.clearInterval(i),o(t=!0))}),10)}var v,g,b={Android:function(){return s.userAgent.match(/Android/i)},BlackBerry:function(){return s.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return s.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return s.userAgent.match(/Opera Mini/i)},Windows:function(){return s.userAgent.match(/IEMobile/i)},any:function(){return b.Android()||b.BlackBerry()||b.iOS()||b.Opera()||b.Windows()},getOsName:function(){var e="Unknown OS";return b.Android()&&(e="Android"),b.BlackBerry()&&(e="BlackBerry"),b.iOS()&&(e="iOS"),b.Opera()&&(e="Opera Mini"),b.Windows()&&(e="Windows"),e}},h="Unknown OS",y="Unknown OS Version",S=function(){for(var e,o=s.appVersion,n=s.userAgent,t="-",i=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],r=0;e=i[r];r++)if(e.r.test(n)){t=e.s;break}var a="-";switch(/Windows/.test(t)&&(/Windows (.*)/.test(t)&&(a=/Windows (.*)/.exec(t)[1]),t="Windows"),t){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(a=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(a=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(a=/OS (\d+)_(\d+)_?(\d+)?/.exec(o))&&a.length>3&&(a=a[1]+"."+a[2]+"."+(0|a[3]))}return{osName:t,osVersion:a}}();S&&S.osName&&"-"!=S.osName?(h=S.osName,y=S.osVersion):b.any()&&"Android"==(h=b.getOsName())&&(y=!!(g=(v=(v||s.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/))&&g[1]);var k="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===h&&k&&(h="Nodejs",y=process.versions.node.toString().replace("v",""));var C=!1,O=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!C&&e in document.createElement("canvas")&&(C=!0),!O&&e in document.createElement("video")&&(O=!0))}));var M=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,T=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,x=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,W=[],D=[],R=[],P=[];s.mediaDevices&&s.mediaDevices.enumerateDevices&&(s.enumerateDevices=function(e){var o=s.mediaDevices.enumerateDevices();o&&o.then?s.mediaDevices.enumerateDevices().then(e).catch((function(){e([])})):e([])});var I=!1;("undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack||s.mediaDevices&&s.mediaDevices.enumerateDevices)&&(I=!0);var E=!1,B=!1,A=!1,N=!1,L=!1;var j=window.DetectRTC||{};j.browser=function(){s.appVersion;var e,o,n,t=s.userAgent,i=s.appName,r=""+parseFloat(s.appVersion),a=parseInt(s.appVersion,10);if(l){i="Opera";try{a=(r=s.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){r="0.0.0.0",a=0}}else w?((o=t.indexOf("rv:"))>0?r=t.substring(o+3):(o=t.indexOf("MSIE"),r=t.substring(o+5)),i="IE"):m?(o=t.indexOf("Chrome"),i="Chrome",r=t.substring(o+7)):p?-1!==t.indexOf("CriOS")?(o=t.indexOf("CriOS"),i="Chrome",r=t.substring(o+6)):-1!==t.indexOf("FxiOS")?(o=t.indexOf("FxiOS"),i="Firefox",r=t.substring(o+6)):(o=t.indexOf("Safari"),i="Safari",r=t.substring(o+7),-1!==(o=t.indexOf("Version"))&&(r=t.substring(o+8)),-1!==s.userAgent.indexOf("Version/")&&(r=s.userAgent.split("Version/")[1].split(" ")[0])):u?(o=t.indexOf("Firefox"),i="Firefox",r=t.substring(o+8)):(e=t.lastIndexOf(" ")+1)<(o=t.lastIndexOf("/"))&&(i=t.substring(e,o),r=t.substring(o+1),i.toLowerCase()===i.toUpperCase()&&(i=s.appName));return c&&(i="Edge",r=s.userAgent.split("Edge/")[1]),-1!==(n=r.search(/[; \)]/))&&(r=r.substring(0,n)),a=parseInt(""+r,10),isNaN(a)&&(r=""+parseFloat(s.appVersion),a=parseInt(s.appVersion,10)),{fullVersion:r,version:a,name:i,isPrivateBrowsing:!1}}(),function(e){var o;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,(function(){o=!1}),(function(e){o=!0}));else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var n;try{(n=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){o=!0}void 0===o&&f((function(){return"done"===n.readyState}),(function(e){e||(o=!n.result)}))}else if(function(e){var o=window.navigator.userAgent.toLowerCase();if(0===o.indexOf("msie")&&0===o.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(o);return!!(n&&parseInt(n[1],10)>=10)}()){o=!1;try{window.indexedDB||(o=!0)}catch(e){o=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){o=!0}void 0===o&&(o=!1,window.localStorage.removeItem("test"))}}catch(e){o=!1}f((function(){return void 0!==o}),(function(e){var n;n=o,j.browser.isPrivateBrowsing=!!n}))}(),j.browser["is"+j.browser.name]=!0,j.osName=h,j.osVersion=y,"object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"];var U=!1;["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){U||e in window&&(U=!0)})),j.isWebRTCSupported=U,j.isORTCSupported="undefined"!=typeof RTCIceGatherer;var F=!1;(j.browser.isChrome&&j.browser.version>=35||j.browser.isFirefox&&j.browser.version>=34||j.browser.isEdge&&j.browser.version>=17||"Android"===j.osName&&j.browser.isChrome)&&(F=!0),(s.getDisplayMedia||s.mediaDevices&&s.mediaDevices.getDisplayMedia)&&(F=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||"")||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(j.browser.isChrome||j.browser.isEdge||j.browser.isOpera)||j.browser.isFirefox)&&(F=!1),j.isScreenCapturingSupported=F;var V={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach((function(e){V.isSupported||e in window&&(V.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(V.isCreateMediaStreamSourceSupported=!0))})),j.isAudioContextSupported=V.isSupported,j.isCreateMediaStreamSourceSupported=V.isCreateMediaStreamSourceSupported;var _=!1;j.browser.isChrome&&j.browser.version>31&&(_=!0),j.isRtpDataChannelsSupported=_;var $=!1;(j.browser.isFirefox&&j.browser.version>28||j.browser.isChrome&&j.browser.version>25||j.browser.isOpera&&j.browser.version>=11)&&($=!0),j.isSctpDataChannelsSupported=$,j.isMobileDevice=d;var q=!1;(s.getUserMedia||s.mediaDevices&&s.mediaDevices.getUserMedia)&&(q=!0),j.browser.isChrome&&j.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(q="Requires HTTPs"),"Nodejs"===j.osName&&(q=!1),j.isGetUserMediaSupported=q;var G,z,H,X="";screen.width&&(X+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:"")),j.displayResolution=X,j.displayAspectRatio=(G=screen.width,z=screen.height,H=function e(o,n){return 0==n?o:e(n,o%n)}(G,z),G/H/(z/H)).toFixed(2),j.isCanvasSupportsStreamCapturing=C,j.isVideoSupportsStreamCapturing=O,"Chrome"==j.browser.name&&j.browser.version>=53&&(j.isCanvasSupportsStreamCapturing||(j.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),j.isVideoSupportsStreamCapturing||(j.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),j.DetectLocalIPAddress=function(e,o){if(j.isWebRTCSupported){var n=!0,t=!0;!function(e,o){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var n={},t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!t){var i=document.getElementById("iframe");if(!i)return;var r=i.contentWindow;t=r.RTCPeerConnection||r.mozRTCPeerConnection||r.webkitRTCPeerConnection}if(t){var a=null;"Chrome"===j.browser&&j.browser.version<58&&(a={optional:[{RtpDataChannels:!0}]});var s=new t({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},a);if(o&&(s.addStream?s.addStream(o):s.addTrack&&o.getTracks()[0]&&s.addTrack(o.getTracks()[0],o)),s.onicecandidate=function(e){e.candidate&&e.candidate.candidate?d(e.candidate.candidate):d()},!o)try{s.createDataChannel("sctp",{})}catch(e){}j.isPromisesSupported?s.createOffer().then((function(e){s.setLocalDescription(e).then(c)})):s.createOffer((function(e){s.setLocalDescription(e,c,(function(){}))}),(function(){}))}}function d(o){if(o){var t=T.exec(o);if(t){var i=t[1];o.match(M);void 0===n[i]&&e(i),n[i]=!0}}else e()}function c(){s.localDescription.sdp.split("\n").forEach((function(e){e&&0===e.indexOf("a=candidate:")&&d(e)}))}}((function(o){o?o.match(M)?e("Local: "+o,n=!1,t):o.match(x)?e("Public: "+o,n,t=!1):e("Public: "+o,n,t):e()}),o)}},j.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,j.isWebSocketsBlocked=!j.isWebSocketsSupported,"Nodejs"===j.osName&&(j.isWebSocketsSupported=!0,j.isWebSocketsBlocked=!1),j.checkWebSocketsSupport=function(e){e=e||function(){};try{var o,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){j.isWebSocketsBlocked=!1,o=(new Date).getTime(),n.send("ping")},n.onmessage=function(){j.WebsocketLatency=(new Date).getTime()-o+"ms",e(),n.close(),n=null},n.onerror=function(){j.isWebSocketsBlocked=!0,e()}}catch(o){j.isWebSocketsBlocked=!0,e()}},j.load=function(e){!function(e){if(I)if(!s.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(s.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!s.enumerateDevices&&s.enumerateDevices&&(s.enumerateDevices=s.enumerateDevices.bind(s)),s.enumerateDevices){W=[],D=[],R=[],P=[],E=!1,B=!1,A=!1,N=!1,L=!1;var o={};s.enumerateDevices((function(n){W=[],D=[],R=[],P=[],n.forEach((function(e){var n={};for(var t in e)try{"function"!=typeof e[t]&&(n[t]=e[t])}catch(e){}o[n.deviceId+n.label+n.kind]||("audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||L||(L=!0),"audioinput"!==n.kind||N||(N=!0)):(n.isCustomLabel=!0,"videoinput"===n.kind?n.label="Camera "+(P.length+1):"audioinput"===n.kind?n.label="Microphone "+(D.length+1):"audiooutput"===n.kind?n.label="Speaker "+(R.length+1):n.label="Please invoke getUserMedia once.",void 0!==j&&j.browser.isChrome&&j.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(E=!0,-1===D.indexOf(n)&&D.push(n)),"audiooutput"===n.kind&&(B=!0,-1===R.indexOf(n)&&R.push(n)),"videoinput"===n.kind&&(A=!0,-1===P.indexOf(n)&&P.push(n)),W.push(n),o[n.deviceId+n.label+n.kind]=n)})),void 0!==j&&(j.MediaDevices=W,j.hasMicrophone=E,j.hasSpeakers=B,j.hasWebcam=A,j.isWebsiteHasWebcamPermissions=L,j.isWebsiteHasMicrophonePermissions=N,j.audioInputDevices=D,j.audioOutputDevices=R,j.videoInputDevices=P),e&&e()}))}else e&&e();else e&&e()}(e=e||function(){})},j.MediaDevices=void 0!==W?W:[],j.hasMicrophone=E,j.hasSpeakers=B,j.hasWebcam=A,j.isWebsiteHasWebcamPermissions=L,j.isWebsiteHasMicrophonePermissions=N,j.audioInputDevices=D,j.audioOutputDevices=R,j.videoInputDevices=P;var K=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(K=!0),j.isSetSinkIdSupported=K;var Y=!1;j.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(Y=!0):j.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(Y=!0),j.isRTPSenderReplaceTracksSupported=Y;var J=!1;j.browser.isFirefox&&j.browser.version>38&&(J=!0),j.isRemoteStreamProcessingSupported=J;var Q=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(Q=!0),j.isApplyConstraintsSupported=Q;var Z=!1;j.browser.isFirefox&&j.browser.version>=43&&(Z=!0),j.isMultiMonitorScreenCapturingSupported=Z,j.isPromisesSupported=!!("Promise"in window),j.version="1.4.1",void 0===j&&(window.DetectRTC={});var ee=window.MediaStream;void 0===ee&&"undefined"!=typeof webkitMediaStream&&(ee=webkitMediaStream),j.MediaStream=void 0!==ee&&"function"==typeof ee&&Object.keys(ee.prototype),"undefined"!=typeof MediaStreamTrack?j.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):j.MediaStreamTrack=!1;var oe=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;j.RTCPeerConnection=void 0!==oe&&Object.keys(oe.prototype),window.DetectRTC=j,e.exports=j,void 0===(t=function(){return j}.apply(o,[]))||(e.exports=t)}()}},o={};function n(t){var i=o[t];if(void 0!==i)return i.exports;var r=o[t]={exports:{}};return e[t](r,r.exports,n),r.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){"use strict";var e=n(847),o=n(914);const t=e=>new Promise((o=>setTimeout(o,e))),i=()=>{let e=!1;if("maxTouchPoints"in navigator)e=navigator.maxTouchPoints>0;else if("msMaxTouchPoints"in navigator)e=navigator.msMaxTouchPoints>0;else{const o=window.matchMedia&&matchMedia("(pointer:coarse)");if(o&&"(pointer:coarse)"===o.media)e=!!o.matches;else if("orientation"in window)e=!0;else{const o=navigator.userAgent;e=/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(o)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(o)}}return e};document.addEventListener("DOMContentLoaded",(function(){const n={meta:{subjID:new URL(document.location.href).searchParams.get("ID")||"testID",order:window.location.pathname.split("/").pop().replace(".html",""),touchscreen:i(),webcam:"true"===new URL(document.location.href).searchParams.get("webcam")||!1},data:[]};o.load((()=>{n.meta.os=o.osName,n.meta.browser=o.browser.name,n.meta.browserVersion=JSON.stringify(o.browser.version),n.meta.safari=o.browser.isSafari||!1,n.meta.iOSSafari=n.meta.touchscreen&&n.meta.safari}));let r=0,a=0,s=0;const d=document.getElementsByTagName("audio"),c=document.getElementById("between-trials"),l=document.getElementById("button-center-item"),u=document.getElementById("speaker"),p=document.getElementById("heading-fullscreen"),m=document.getElementById("heading-testsound"),w=async e=>{e.preventDefault(),s=(new Date).getTime();const o=document.getElementById("trial"+(r-1));Array.from(o.getElementsByTagName("img")).forEach((e=>{e.style.border="0.3vw solid black"})),e.target.style.border="0.3vw solid blue",n.data[r-2]={timestamp:new Date(parseInt(s)).toISOString(),responseTime:s-a,trial:r-1,targetWord:d[r-1].src.split("/").pop().replace("N_","").replace("sm_","").replace(".mp3",""),chosenWord:e.target.src.split("/").pop().replace("N_","").replace(".jpg",""),chosenCategory:e.target.dataset.wordCategory,chosenPosition:e.target.classList[0]},l.addEventListener("click",f,{capture:!1,once:!0})},f=async o=>{if(o.preventDefault(),0===r&&(!0&!n.meta.iOSSafari&&(()=>{const e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()})(),p.style.display="none",m.style.display="inline",u.setAttribute("visibility","visible"),await t(1e3),d[r].play(),await t(2e3),l.addEventListener("click",f,{capture:!1,once:!0})),r===document.querySelectorAll('[id^="trial"]').length){if(((e,o)=>{e.forEach((e=>{e.subjID=o,e.correct=e.targetWord===e.chosenWord}));const n=["subjID","trial","targetWord","chosenWord","chosenCategory","chosenPosition","correct","timestamp","responseTime"],t=[];t.push(["id","trial","target_word","chosen_word","chosen_category","chosen_position","correct","timestamp","responsetime_ms"]),e.forEach((e=>{const o=n.map((o=>e[o]));t.push(o)}));let i="";t.forEach((e=>{i+=e.join(",")+"\n"}));const r=(new Date).toISOString().substring(0,10),a=(new Date).toISOString().substring(11,19),s=new Blob([i],{type:"text/csv;charset=utf-8,"}),d=URL.createObjectURL(s),c=document.createElement("a");c.setAttribute("href",d),c.setAttribute("download",`orev-demo-${o}-${r}-${a}.csv`),c.click()})(n.data,n.meta.subjID),!n.meta.iOSSafari&&n.meta.webcam){e.stopRecorder();const o=(new Date).toISOString().substring(0,10),t=(new Date).toISOString().substring(11,19);setTimeout((()=>e.downloadVideo(`orev-${n.meta.subjID}-${o}-${t}`)),1e3)}await t(1e3),window.location.href=`./goodbye.html?ID=${n.meta.subjID}`}if(r>0){m.style.display="none",d[r-1].pause(),d[r-1].currentTime=0,document.getElementById("trial"+(r-1)).style.display="none",c.style.display="flex",await t(150),d[r].play(),await t(0),a=(new Date).getTime(),c.style.display="none";const e=document.getElementById(`trial${r}`);e.style.display="flex";const o=Array.from(e.getElementsByTagName("img"));d[r].onended=()=>{o.forEach((e=>{e.addEventListener("click",w,{capture:!1,once:!1})}))}}r++};l.addEventListener("click",f,{capture:!1,once:!0}),u.addEventListener("click",(async e=>{e.preventDefault(),r>1&&(d[r-1].pause(),d[r-1].currentTime=0),d[r-1].play()}),{capture:!1,once:!1}),(async()=>{await t(500),!n.meta.iOSSafari&&n.meta.webcam&&e.startRecorder({audio:!0,video:{frameRate:{min:10,ideal:25,max:30},width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080},facingMode:"user"}}),await t(2500),l.style.display="inline"})()}))}()}();
//# sourceMappingURL=orev.js.map